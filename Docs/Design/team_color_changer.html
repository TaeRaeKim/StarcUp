<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íŒ€ ì»¬ëŸ¬ ë³€ê²½ í”„ë¡œê·¸ë¨</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            color: white;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 30px;
            justify-content: center;
            align-items: center;
        }
        
        .file-input-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        
        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .file-input-wrapper:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        
        .file-input-wrapper input[type=file] {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }
        
        .drop-zone {
            width: 280px;
            height: 200px;
            border: 3px dashed rgba(255, 255, 255, 0.5);
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 0;
            position: relative;
        }
        
        .drop-zone:hover {
            border-color: rgba(255, 255, 255, 0.8);
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        .drop-zone.dragover {
            border-color: #00ff00;
            background: rgba(0, 255, 0, 0.1);
            transform: scale(1.02);
        }
        
        .drop-zone-text {
            text-align: center;
            font-size: 16px;
            margin-bottom: 10px;
        }
        
        .drop-zone-subtext {
            font-size: 12px;
            opacity: 0.7;
            text-align: center;
        }
        
        .color-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
        }
        
        .color-group {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 15px;
        }
        
        .color-picker {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .color-picker:hover {
            transform: scale(1.1);
        }
        
        .preset-colors {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 15px;
            justify-items: center;
            max-width: 300px;
        }
        
        .preset-color {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            border: 3px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            position: relative;
        }
        
        .preset-color:hover {
            transform: scale(1.2);
            border-color: white;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
        }
        
        .preset-color:hover::after {
            content: attr(title);
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 1000;
        }
        
        .size-control {
            margin-top: 10px;
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        
        .size-options {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 10px;
            justify-content: center;
        }
        
        .radio-label {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            font-size: 13px;
            color: white;
            transition: all 0.3s ease;
            padding: 4px 8px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
        }
        
        .radio-label:hover {
            color: #00ff88;
            background: rgba(255, 255, 255, 0.15);
        }
        
        .radio-label input[type="radio"] {
            appearance: none;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .radio-label input[type="radio"]:checked {
            background: #00ff88;
            border-color: #00ff88;
        }
        
        .radio-label input[type="radio"]:checked::after {
            content: '';
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 6px;
            height: 6px;
            background: white;
            border-radius: 50%;
        }
        
        .radio-label input[type="radio"]:hover {
            border-color: rgba(255, 255, 255, 0.8);
        }
        
        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            font-size: 14px;
            color: white;
            transition: all 0.3s ease;
        }
        
        .checkbox-label:hover {
            color: #00ff88;
        }
        
        .checkbox-label input[type="checkbox"] {
            appearance: none;
            width: 18px;
            height: 18px;
            border: 2px solid rgba(255, 255, 255, 0.5);
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.1);
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .checkbox-label input[type="checkbox"]:checked {
            background: #00ff88;
            border-color: #00ff88;
        }
        
        .checkbox-label input[type="checkbox"]:checked::after {
            content: 'âœ“';
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        
        .checkbox-label input[type="checkbox"]:hover {
            border-color: rgba(255, 255, 255, 0.8);
        }
        
        .small-size-container {
            background-color: rgba(0, 0, 0, 0.75) !important;
            border: 2px solid rgba(255, 255, 255, 0.3) !important;
            border-radius: 4px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            position: relative !important;
        }
        
        .download-btn {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
            margin-top: 8px;
        }
        
        .download-btn:hover {
            background: linear-gradient(135deg, #45a049, #3d8b40);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
        }
        
        .download-btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(76, 175, 80, 0.3);
        }
        
        .download-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .canvas-container {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            margin-top: 30px;
        }
        
        .canvas-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            min-height: 350px; /* 32x32 ëª¨ë“œì—ì„œë„ ë ˆì´ì•„ì›ƒ ì•ˆì •ì„± í™•ë³´ */
            justify-content: flex-start;
        }
        
        .canvas-group canvas {
            display: block;
            margin: 0 auto;
        }
        
        canvas {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 15px;
            background-image: 
                linear-gradient(45deg, #ccc 25%, transparent 25%), 
                linear-gradient(-45deg, #ccc 25%, transparent 25%), 
                linear-gradient(45deg, transparent 75%, #ccc 75%), 
                linear-gradient(-45deg, transparent 75%, #ccc 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease;
        }
        
        #resultCanvas {
            background: transparent !important;
        }
        
        canvas:hover {
            transform: scale(1.02);
        }
        
        .canvas-label {
            font-size: 18px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .info {
            text-align: center;
            margin-top: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            line-height: 1.6;
        }
        
        .sample-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
            margin-top: 5px;
        }
        
        .sample-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
        }
        
        .debug-info {
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 10px;
            margin-top: 20px;
            font-family: monospace;
            font-size: 12px;
            color: #ccc;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¨ íŒ€ ì»¬ëŸ¬ ë³€ê²½ í”„ë¡œê·¸ë¨</h1>
        
        <div class="controls">
            <div class="file-input-group">
                <div class="drop-zone" id="diffuseDropZone">
                    <div class="drop-zone-text">ğŸ“¸ Diffuse ì´ë¯¸ì§€</div>
                    <div class="drop-zone-subtext">í´ë¦­í•˜ê±°ë‚˜ íŒŒì¼ì„ ë“œë˜ê·¸í•˜ì„¸ìš”</div>
                    <input type="file" id="diffuseFile" accept="image/*" style="display: none;">
                </div>
                <div class="file-input-wrapper" onclick="document.getElementById('diffuseFile').click()">
                    <span>ğŸ“ íŒŒì¼ ì„ íƒ</span>
                </div>
                <button class="sample-btn" onclick="teamColorChanger.createSampleDiffuse()">ìƒ˜í”Œ ìƒì„±</button>
            </div>
            
            <div class="file-input-group">
                <div class="drop-zone" id="teamColorDropZone">
                    <div class="drop-zone-text">ğŸ¯ Team Color ë§ˆìŠ¤í¬</div>
                    <div class="drop-zone-subtext">í´ë¦­í•˜ê±°ë‚˜ íŒŒì¼ì„ ë“œë˜ê·¸í•˜ì„¸ìš”</div>
                    <input type="file" id="teamColorFile" accept="image/*" style="display: none;">
                </div>
                <div class="file-input-wrapper" onclick="document.getElementById('teamColorFile').click()">
                    <span>ğŸ“ íŒŒì¼ ì„ íƒ</span>
                </div>
                <button class="sample-btn" onclick="teamColorChanger.createSampleMask()">ìƒ˜í”Œ ìƒì„±</button>
            </div>
            
            <div class="color-controls">
                <div class="color-group">
                    <label>íŒ€ ì»¬ëŸ¬:</label>
                    <input type="color" id="teamColorPicker" class="color-picker" value="#F40404">
                </div>
                
                <div class="preset-colors">
                    <div class="preset-color" style="background-color: #F40404" data-color="#F40404" title="Red"></div>
                    <div class="preset-color" style="background-color: #0C48CC" data-color="#0C48CC" title="Blue"></div>
                    <div class="preset-color" style="background-color: #2CB494" data-color="#2CB494" title="Teal"></div>
                    <div class="preset-color" style="background-color: #88409C" data-color="#88409C" title="Purple"></div>
                    <div class="preset-color" style="background-color: #F88C14" data-color="#F88C14" title="Orange"></div>
                    <div class="preset-color" style="background-color: #703014" data-color="#703014" title="Brown"></div>
                    <div class="preset-color" style="background-color: #CCE0D0" data-color="#CCE0D0" title="White"></div>
                    <div class="preset-color" style="background-color: #FCFC38" data-color="#FCFC38" title="Yellow"></div>
                </div>
            </div>
        </div>
        
        <div class="canvas-container">
            <div class="canvas-group">
                <canvas id="originalCanvas" width="300" height="300"></canvas>
                <div class="canvas-label">ì›ë³¸ ì´ë¯¸ì§€</div>
            </div>
            
            <div class="canvas-group">
                <canvas id="maskCanvas" width="300" height="300"></canvas>
                <div class="canvas-label">íŒ€ ì»¬ëŸ¬ ë§ˆìŠ¤í¬</div>
            </div>
            
            <div class="canvas-group">
                <canvas id="resultCanvas" width="300" height="300"></canvas>
                <div class="canvas-label">ê²°ê³¼ ì´ë¯¸ì§€</div>
                <div class="size-control">
                    <div class="size-options">
                        <label class="radio-label">
                            <input type="radio" name="sizeToggle" id="originalSizeToggle" checked>
                            <span class="checkmark"></span>
                            ì›ë³¸ í¬ê¸°
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="sizeToggle" id="size32Toggle" value="32">
                            <span class="checkmark"></span>
                            32x32
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="sizeToggle" id="size48Toggle" value="48">
                            <span class="checkmark"></span>
                            48x48
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="sizeToggle" id="size64Toggle" value="64">
                            <span class="checkmark"></span>
                            64x64
                        </label>
                    </div>
                    <label class="checkbox-label">
                        <input type="checkbox" id="autoCropToggle" checked>
                        <span class="checkmark"></span>
                        ë™ì  ìº”ë²„ìŠ¤ í¬ê¸° ì¡°ì ˆ
                    </label>
                    <button class="download-btn" onclick="teamColorChanger.downloadResult()">
                        ğŸ“¥ ê²°ê³¼ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
                    </button>
                </div>
            </div>
        </div>
        
        <div class="info">
            <p><strong>ì‚¬ìš© ë°©ë²•:</strong></p>
            <p>1. <strong>íŒŒì¼ ì—…ë¡œë“œ ë°©ë²•:</strong></p>
            <p>   â€¢ ë“œë¡­ì¡´ì„ í´ë¦­í•˜ì—¬ íŒŒì¼ ì„ íƒ</p>
            <p>   â€¢ íŒŒì¼ì„ ë“œë˜ê·¸í•´ì„œ ë“œë¡­ì¡´ì— ë“œë¡­</p>
            <p>   â€¢ "íŒŒì¼ ì„ íƒ" ë²„íŠ¼ í´ë¦­</p>
            <p>   â€¢ "ìƒ˜í”Œ ìƒì„±" ë²„íŠ¼ìœ¼ë¡œ í…ŒìŠ¤íŠ¸</p>
            <p>2. íŒ€ ì»¬ëŸ¬ë¥¼ ì„ íƒí•˜ê±°ë‚˜ í”„ë¦¬ì…‹ ì»¬ëŸ¬ë¥¼ í´ë¦­í•˜ì„¸ìš”</p>
            <p>3. ì‹¤ì‹œê°„ìœ¼ë¡œ íŒ€ ì»¬ëŸ¬ê°€ ì ìš©ëœ ê²°ê³¼ë¥¼ í™•ì¸í•˜ì„¸ìš”!</p>
            <p>4. <strong>"ë™ì  ìº”ë²„ìŠ¤ í¬ê¸° ì¡°ì ˆ"</strong>ë¡œ ìº”ë²„ìŠ¤ë¥¼ ê°ì²´ í¬ê¸°ì— ë”± ë§ê²Œ ì¡°ì ˆ (ì™„ì „í•œ ì—¬ë°± ì œê±°)</p>
            <p>5. <strong>í¬ê¸° ì˜µì…˜ ì„ íƒ</strong>ìœ¼ë¡œ 32x32, 48x48, 64x64 í¬ê¸°ë¡œ ê²Œì„ ë‚´ ì‹¤ì œ í¬ê¸° í™•ì¸</p>
            <p>6. <strong>"ê²°ê³¼ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ"</strong>ë¡œ ì™„ì„±ëœ íŒ€ ì»¬ëŸ¬ ì´ë¯¸ì§€ ì €ì¥</p>
            <p><small>ğŸ¯ í”½ì…€ í¼í™íŠ¸: ë™ì  í¬ê¸° ì¡°ì ˆ ì‹œ íŒ¨ë”© ì—†ì´ ì™„ì „í•œ ì—¬ë°± ì œê±°</small></p>
            <p><small>âš¡ í¬ê¸° ì•ˆì •ì„±: ìƒ‰ìƒ ë³€ê²½ ì‹œì—ë„ ì´ë¯¸ì§€ í¬ê¸°ê°€ ì¼ì •í•˜ê²Œ ìœ ì§€</small></p>
        </div>
        
        <div id="debugInfo" class="debug-info" style="display: none;"></div>
    </div>

    <script>
        class TeamColorChanger {
            constructor() {
                this.diffuseImage = null;
                this.teamColorImage = null;
                this.currentTeamColor = '#F40404'; // Redë¡œ ê¸°ë³¸ê°’ ë³€ê²½
                this.autoCropEnabled = true; // ìë™ ì—¬ë°± ì œê±° ê¸°ë³¸ê°’
                
                this.initializeCanvases();
                this.bindEvents();
            }
            
            initializeCanvases() {
                this.originalCanvas = document.getElementById('originalCanvas');
                this.maskCanvas = document.getElementById('maskCanvas');
                this.resultCanvas = document.getElementById('resultCanvas');
                
                this.originalCtx = this.originalCanvas.getContext('2d');
                this.maskCtx = this.maskCanvas.getContext('2d');
                this.resultCtx = this.resultCanvas.getContext('2d');
                
                // ê¸°ë³¸ ë°°ê²½ ì„¤ì •
                this.clearCanvas(this.originalCtx, 'ì›ë³¸ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”');
                this.clearCanvas(this.maskCtx, 'íŒ€ ì»¬ëŸ¬ ë§ˆìŠ¤í¬ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”');
                this.clearCanvas(this.resultCtx, 'ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ë©´ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤');
                
                // ê²°ê³¼ ìº”ë²„ìŠ¤ í¬ê¸° ì´ˆê¸°í™”
                this.resetResultCanvasSize();
            }
            
            resetResultCanvasSize() {
                // ê²°ê³¼ ìº”ë²„ìŠ¤ë¥¼ ê¸°ë³¸ í¬ê¸°ë¡œ ì¬ì„¤ì •
                this.resultCanvas.width = 300;
                this.resultCanvas.height = 300;
                this.clearCanvas(this.resultCtx, 'ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ë©´ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤');
            }
            
            clearCanvas(ctx, text) {
                ctx.clearRect(0, 0, 300, 300);
                // ë°˜íˆ¬ëª… íšŒìƒ‰ ë°°ê²½ìœ¼ë¡œ í…ìŠ¤íŠ¸ ê°€ë…ì„± í™•ë³´
                ctx.fillStyle = 'rgba(240, 240, 240, 0.8)';
                ctx.fillRect(50, 140, 200, 30);
                ctx.fillStyle = '#666';
                ctx.font = '14px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(text, 150, 160);
            }
            
            bindEvents() {
                // íŒŒì¼ ì—…ë¡œë“œ ì´ë²¤íŠ¸
                document.getElementById('diffuseFile').addEventListener('change', (e) => {
                    this.log('Diffuse íŒŒì¼ ì„ íƒë¨');
                    this.loadImage(e.target.files[0], 'diffuse');
                });
                
                document.getElementById('teamColorFile').addEventListener('change', (e) => {
                    this.log('Team Color íŒŒì¼ ì„ íƒë¨');
                    this.loadImage(e.target.files[0], 'teamColor');
                });
                
                // ë“œë˜ê·¸ì•¤ë“œë¡­ ì´ë²¤íŠ¸ ì„¤ì •
                this.setupDropZone('diffuseDropZone', 'diffuseFile', 'diffuse');
                this.setupDropZone('teamColorDropZone', 'teamColorFile', 'teamColor');
                
                // ì»¬ëŸ¬ í”¼ì»¤ ì´ë²¤íŠ¸
                document.getElementById('teamColorPicker').addEventListener('input', (e) => {
                    this.currentTeamColor = e.target.value;
                    this.log(`íŒ€ ì»¬ëŸ¬ ë³€ê²½: ${this.currentTeamColor}`);
                    this.applyTeamColor();
                });
                
                // í”„ë¦¬ì…‹ ì»¬ëŸ¬ ì´ë²¤íŠ¸
                document.querySelectorAll('.preset-color').forEach(colorDiv => {
                    colorDiv.addEventListener('click', (e) => {
                        const color = e.target.dataset.color;
                        const colorName = e.target.getAttribute('title');
                        this.currentTeamColor = color;
                        document.getElementById('teamColorPicker').value = color;
                        this.log(`í”„ë¦¬ì…‹ ì»¬ëŸ¬ ì„ íƒ: ${colorName} (${color})`);
                        this.applyTeamColor();
                    });
                });
                
                // í¬ê¸° ë¼ë””ì˜¤ ë²„íŠ¼ ì´ë²¤íŠ¸
                document.querySelectorAll('input[name="sizeToggle"]').forEach(radio => {
                    radio.addEventListener('change', (e) => {
                        if (e.target.checked) {
                            const size = e.target.value || 'original';
                            this.toggleSize(size);
                        }
                    });
                });
                
                // ìë™ ì—¬ë°± ì œê±° í† ê¸€ ì´ë²¤íŠ¸
                document.getElementById('autoCropToggle').addEventListener('change', (e) => {
                    this.autoCropEnabled = e.target.checked;
                    this.log(`ë™ì  ìº”ë²„ìŠ¤ í¬ê¸° ì¡°ì ˆ: ${this.autoCropEnabled ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}`);
                    if (!this.autoCropEnabled) {
                        // ë¹„í™œì„±í™” ì‹œ ìº”ë²„ìŠ¤ í¬ê¸°ë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ë³µì›
                        this.resetResultCanvasSize();
                    }
                    this.applyTeamColor();
                });
            }
            
            setupDropZone(dropZoneId, fileInputId, type) {
                const dropZone = document.getElementById(dropZoneId);
                const fileInput = document.getElementById(fileInputId);
                
                // í´ë¦­ìœ¼ë¡œ íŒŒì¼ ì„ íƒ
                dropZone.addEventListener('click', () => {
                    this.log(`${type} íŒŒì¼ ì„ íƒ ì°½ ì—´ê¸°`);
                    fileInput.click();
                });
                
                // ë“œë˜ê·¸ ì´ë²¤íŠ¸ ë°©ì§€
                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    dropZone.addEventListener(eventName, (e) => {
                        e.preventDefault();
                        e.stopPropagation();
                    });
                });
                
                // ë“œë˜ê·¸ ì˜¤ë²„ ì‹œê°ì  í”¼ë“œë°±
                ['dragenter', 'dragover'].forEach(eventName => {
                    dropZone.addEventListener(eventName, () => {
                        dropZone.classList.add('dragover');
                    });
                });
                
                ['dragleave', 'drop'].forEach(eventName => {
                    dropZone.addEventListener(eventName, () => {
                        dropZone.classList.remove('dragover');
                    });
                });
                
                // íŒŒì¼ ë“œë¡­ ì²˜ë¦¬
                dropZone.addEventListener('drop', (e) => {
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        const file = files[0];
                        if (file.type.startsWith('image/')) {
                            this.log(`${type} íŒŒì¼ ë“œë¡­ë¨: ${file.name}`);
                            this.loadImage(file, type);
                            // íŒŒì¼ inputì—ë„ ë°˜ì˜
                            const dataTransfer = new DataTransfer();
                            dataTransfer.items.add(file);
                            fileInput.files = dataTransfer.files;
                        } else {
                            this.log(`${type}: ì´ë¯¸ì§€ íŒŒì¼ì´ ì•„ë‹™ë‹ˆë‹¤`);
                            alert('ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                        }
                    }
                });
                
                // ì „ì²´ í˜ì´ì§€ ë“œë˜ê·¸ ë°©ì§€
                document.addEventListener('dragover', (e) => {
                    e.preventDefault();
                });
                document.addEventListener('drop', (e) => {
                    e.preventDefault();
                });
            }
            
            log(message) {
                const debugDiv = document.getElementById('debugInfo');
                debugDiv.style.display = 'block';
                debugDiv.innerHTML += `[${new Date().toLocaleTimeString()}] ${message}<br>`;
                console.log(message);
            }
            
            createSampleDiffuse() {
                this.log('ìƒ˜í”Œ Diffuse ì´ë¯¸ì§€ ìƒì„± ì¤‘...');
                const canvas = document.createElement('canvas');
                canvas.width = 200;
                canvas.height = 200;
                const ctx = canvas.getContext('2d');
                
                // íˆ¬ëª… ë°°ê²½ (ê²€ì€ ë°°ê²½ ëŒ€ì‹ )
                
                // íŒ€ ì»¬ëŸ¬ê°€ ì ìš©ë  ë¶€ë¶„ì„ í°ìƒ‰ìœ¼ë¡œ
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(85, 60, 30, 20); // ê°€ìŠ´ ë¶€ë¶„
                ctx.fillRect(90, 40, 20, 20); // ë¨¸ë¦¬ ë¶€ë¶„
                ctx.fillRect(70, 75, 8, 8); // ì™¼ìª½ ì–´ê¹¨ ì¥ì‹
                ctx.fillRect(122, 75, 8, 8); // ì˜¤ë¥¸ìª½ ì–´ê¹¨ ì¥ì‹
                
                // íšŒìƒ‰ìœ¼ë¡œ ì•½ê°„ì˜ íŒ€ ì»¬ëŸ¬ ì ìš©
                ctx.fillStyle = '#808080';
                ctx.fillRect(75, 140, 50, 10); // í•˜ì²´ ì¼ë¶€
                ctx.fillRect(99, 35, 2, 10); // ì•ˆí…Œë‚˜
                
                canvas.toBlob((blob) => {
                    const url = URL.createObjectURL(blob);
                    const img = new Image();
                    img.onload = () => {
                        this.teamColorImage = img;
                        this.drawImageToCanvas(img, this.maskCtx);
                        this.log('[SAMPLE] Team Color ë§ˆìŠ¤í¬ ìƒì„± ì™„ë£Œ (íˆ¬ëª… ë°°ê²½)');
                        // ìƒ˜í”Œ ìƒì„± ì‹œ ê²°ê³¼ ìº”ë²„ìŠ¤ í¬ê¸° ì´ˆê¸°í™”
                        this.resetResultCanvasSize();
                        this.applyTeamColor();
                        URL.revokeObjectURL(url);
                    };
                    img.src = url;
                }, 'image/png'); // PNGë¡œ íˆ¬ëª…ë„ ë³´ì¡´
            }
            
            loadImage(file, type) {
                if (!file) {
                    this.log(`${type} íŒŒì¼ì´ ì„ íƒë˜ì§€ ì•ŠìŒ`);
                    return;
                }
                
                this.log(`${type} íŒŒì¼ ë¡œë”© ì‹œì‘: ${file.name} (${file.size} bytes)`);
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    this.log(`${type} íŒŒì¼ ì½ê¸° ì™„ë£Œ`);
                    const img = new Image();
                    img.onload = () => {
                        this.log(`${type} ì´ë¯¸ì§€ ë¡œë”© ì™„ë£Œ: ${img.width}x${img.height}`);
                        if (type === 'diffuse') {
                            this.diffuseImage = img;
                            this.drawImageToCanvas(img, this.originalCtx);
                        } else if (type === 'teamColor') {
                            this.teamColorImage = img;
                            this.drawImageToCanvas(img, this.maskCtx);
                        }
                        // ìƒˆ ì´ë¯¸ì§€ ë¡œë“œ ì‹œ ê²°ê³¼ ìº”ë²„ìŠ¤ í¬ê¸° ì´ˆê¸°í™”
                        this.resetResultCanvasSize();
                        this.applyTeamColor();
                    };
                    img.onerror = (error) => {
                        this.log(`${type} ì´ë¯¸ì§€ ë¡œë”© ì‹¤íŒ¨: ${error}`);
                    };
                    img.src = e.target.result;
                };
                reader.onerror = (error) => {
                    this.log(`${type} íŒŒì¼ ì½ê¸° ì‹¤íŒ¨: ${error}`);
                };
                reader.readAsDataURL(file);
            }
            
            drawImageToCanvas(img, ctx) {
                const canvas = ctx.canvas;
                const scale = Math.min(canvas.width / img.width, canvas.height / img.height);
                const width = img.width * scale;
                const height = img.height * scale;
                const x = (canvas.width - width) / 2;
                const y = (canvas.height - height) / 2;
                
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                // íˆ¬ëª… ë°°ê²½ì„ ìœ„í•´ fillRect ì œê±°
                ctx.drawImage(img, x, y, width, height);
            }
            
            hexToRgb(hex) {
                const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                return result ? {
                    r: parseInt(result[1], 16),
                    g: parseInt(result[2], 16),
                    b: parseInt(result[3], 16)
                } : null;
            }
            
            applyTeamColor() {
                if (!this.diffuseImage || !this.teamColorImage) {
                    return;
                }
                
                // ì›ë³¸ í¬ê¸°ë¡œ ì„ì‹œ ìº”ë²„ìŠ¤ ìƒì„±í•˜ì—¬ í¬ê¸° ì¶•ì†Œ ë°©ì§€
                const tempCanvas = document.createElement('canvas');
                const tempCtx = tempCanvas.getContext('2d');
                tempCanvas.width = 300;
                tempCanvas.height = 300;
                
                // íŒ€ ì»¬ëŸ¬ ë§ˆìŠ¤í¬ìš© ì„ì‹œ ìº”ë²„ìŠ¤
                const maskCanvas = document.createElement('canvas');
                const maskCtx = maskCanvas.getContext('2d');
                maskCanvas.width = 300;
                maskCanvas.height = 300;
                
                // ì›ë³¸ í¬ê¸°ë¡œ diffuse ì´ë¯¸ì§€ ê·¸ë¦¬ê¸°
                this.drawImageToCanvas(this.diffuseImage, tempCtx);
                
                // ì›ë³¸ í¬ê¸°ë¡œ íŒ€ ì»¬ëŸ¬ ë§ˆìŠ¤í¬ ê·¸ë¦¬ê¸°
                this.drawImageToCanvas(this.teamColorImage, maskCtx);
                
                // ì´ë¯¸ì§€ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                const diffuseData = tempCtx.getImageData(0, 0, 300, 300);
                const maskData = maskCtx.getImageData(0, 0, 300, 300);
                const resultData = tempCtx.createImageData(300, 300);
                
                const teamColor = this.hexToRgb(this.currentTeamColor);
                
                // í”½ì…€ë³„ë¡œ ì²˜ë¦¬
                for (let i = 0; i < diffuseData.data.length; i += 4) {
                    const maskIntensity = maskData.data[i] / 255; // ë§ˆìŠ¤í¬ì˜ ë°ê¸° (0-1)
                    
                    if (maskIntensity > 0.1) { // ë§ˆìŠ¤í¬ê°€ ìˆëŠ” ë¶€ë¶„
                        // ì›ë³¸ ìƒ‰ìƒê³¼ íŒ€ ì»¬ëŸ¬ë¥¼ ë¸”ë Œë”©
                        const originalR = diffuseData.data[i];
                        const originalG = diffuseData.data[i + 1];
                        const originalB = diffuseData.data[i + 2];
                        
                        // íŒ€ ì»¬ëŸ¬ë¥¼ ì›ë³¸ì˜ ëª…ë„ì— ë”°ë¼ ì¡°ì •
                        const brightness = (originalR + originalG + originalB) / (3 * 255);
                        
                        resultData.data[i] = teamColor.r * brightness * maskIntensity + originalR * (1 - maskIntensity);
                        resultData.data[i + 1] = teamColor.g * brightness * maskIntensity + originalG * (1 - maskIntensity);
                        resultData.data[i + 2] = teamColor.b * brightness * maskIntensity + originalB * (1 - maskIntensity);
                        resultData.data[i + 3] = diffuseData.data[i + 3]; // ì•ŒíŒŒ ì±„ë„ ìœ ì§€
                    } else {
                        // ë§ˆìŠ¤í¬ê°€ ì—†ëŠ” ë¶€ë¶„ì€ ì›ë³¸ ê·¸ëŒ€ë¡œ
                        resultData.data[i] = diffuseData.data[i];
                        resultData.data[i + 1] = diffuseData.data[i + 1];
                        resultData.data[i + 2] = diffuseData.data[i + 2];
                        resultData.data[i + 3] = diffuseData.data[i + 3];
                    }
                }
                
                // ê²°ê³¼ë¥¼ ì„ì‹œ ìº”ë²„ìŠ¤ì— ê·¸ë¦¬ê¸°
                tempCtx.putImageData(resultData, 0, 0);
                
                // ê²°ê³¼ ìº”ë²„ìŠ¤ í¬ê¸° ì´ˆê¸°í™”
                const resultCanvas = this.resultCanvas;
                const resultCtx = this.resultCtx;
                
                if (this.autoCropEnabled) {
                    // ë™ì  í¬ê¸° ì¡°ì ˆì´ í™œì„±í™”ëœ ê²½ìš°, ì„ì‹œ ìº”ë²„ìŠ¤ì—ì„œ í¬ë¡­
                    this.applyCropToCanvas(tempCtx, resultCtx);
                } else {
                    // ê³ ì • í¬ê¸° ëª¨ë“œ: 300x300ìœ¼ë¡œ ì„¤ì • í›„ ì´ë¯¸ì§€ ë³µì‚¬
                    resultCanvas.width = 300;
                    resultCanvas.height = 300;
                    resultCtx.clearRect(0, 0, 300, 300);
                    resultCtx.drawImage(tempCanvas, 0, 0);
                }
            }
            
            // í¬ë¡­ ì ìš© í•¨ìˆ˜ (ì›ë³¸ í¬ê¸°ì—ì„œ í¬ë¡­í•˜ì—¬ ê²°ê³¼ ìº”ë²„ìŠ¤ì— ì ìš©)
            applyCropToCanvas(sourceCtx, targetCtx) {
                const sourceCanvas = sourceCtx.canvas;
                const imageData = sourceCtx.getImageData(0, 0, sourceCanvas.width, sourceCanvas.height);
                const data = imageData.data;
                
                let minX = sourceCanvas.width;
                let minY = sourceCanvas.height;
                let maxX = -1;
                let maxY = -1;
                
                // ì˜ë¯¸ìˆëŠ” í”½ì…€ ì„ê³„ê°’ (íˆ¬ëª…ë„ 10% ì´ìƒ)
                const alphaThreshold = 25;
                
                // íˆ¬ëª…í•˜ì§€ ì•Šì€ í”½ì…€ì˜ ì •í™•í•œ ê²½ê³„ ì°¾ê¸°
                for (let y = 0; y < sourceCanvas.height; y++) {
                    for (let x = 0; x < sourceCanvas.width; x++) {
                        const index = (y * sourceCanvas.width + x) * 4;
                        const alpha = data[index + 3];
                        
                        if (alpha > alphaThreshold) { // ì‹œê°ì ìœ¼ë¡œ ì˜ë¯¸ìˆëŠ” í”½ì…€ë§Œ
                            minX = Math.min(minX, x);
                            minY = Math.min(minY, y);
                            maxX = Math.max(maxX, x);
                            maxY = Math.max(maxY, y);
                        }
                    }
                }
                
                // ìœ íš¨í•œ ê°ì²´ê°€ ìˆëŠ” ê²½ìš°ì—ë§Œ í¬ë¡­
                if (maxX >= minX && maxY >= minY) {
                    const finalWidth = maxX - minX + 1;
                    const finalHeight = maxY - minY + 1;
                    
                    // ì •í™•í•œ ê²½ê³„ë¡œ í¬ë¡­ëœ ì˜ì—­ ì¶”ì¶œ
                    const croppedImageData = sourceCtx.getImageData(minX, minY, finalWidth, finalHeight);
                    
                    // ê²°ê³¼ ìº”ë²„ìŠ¤ í¬ê¸°ë¥¼ ì •í™•í•œ ê°ì²´ í¬ê¸°ë¡œ ë³€ê²½
                    const targetCanvas = targetCtx.canvas;
                    targetCanvas.width = finalWidth;
                    targetCanvas.height = finalHeight;
                    
                    // ìº”ë²„ìŠ¤ í´ë¦¬ì–´ í›„ í¬ë¡­ëœ ì´ë¯¸ì§€ ê·¸ë¦¬ê¸°
                    targetCtx.clearRect(0, 0, finalWidth, finalHeight);
                    targetCtx.putImageData(croppedImageData, 0, 0);
                    
                    this.log(`ì™„ì „í•œ ì—¬ë°± ì œê±° ì™„ë£Œ: ì›ë³¸(300x300) â†’ ìµœì í™”(${finalWidth}x${finalHeight}) | ê³µê°„ ì ˆì•½: ${(100 - (finalWidth * finalHeight) / (300 * 300) * 100).toFixed(1)}%`);
                } else {
                    this.log('í¬ë¡­í•  ê°ì²´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ (íˆ¬ëª…ë„ ì„ê³„ê°’: ' + alphaThreshold + ')');
                }
            }
            
            // ì¤‘ì‹¬ì ì„ ë¹¨ê°„ ì ìœ¼ë¡œ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜ (ì œê±°ë¨ - ë™ì  í¬ê¸° ì¡°ì ˆì—ì„œ ë¶ˆí•„ìš”)
            drawCenterPoint(ctx) {
                // ì´ í•¨ìˆ˜ëŠ” ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤
                return;
            }
            
            // ê²°ê³¼ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ í•¨ìˆ˜
            downloadResult() {
                const resultCanvas = document.getElementById('resultCanvas');
                
                if (!this.diffuseImage || !this.teamColorImage) {
                    alert('ë‹¤ìš´ë¡œë“œí•˜ë ¤ë©´ ë¨¼ì € ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ê±°ë‚˜ ìƒ˜í”Œì„ ìƒì„±í•˜ì„¸ìš”.');
                    return;
                }
                
                // í˜„ì¬ íŒ€ ì»¬ëŸ¬ ì´ë¦„ ê°€ì ¸ì˜¤ê¸°
                const colorName = this.getCurrentColorName();
                const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
                const filename = `team_color_${colorName}_${timestamp}.png`;
                
                // ë‹¤ìš´ë¡œë“œ ì‹¤í–‰
                resultCanvas.toBlob((blob) => {
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
                    
                    this.log(`ë‹¤ìš´ë¡œë“œ ì™„ë£Œ: ${filename}`);
                }, 'image/png');
            }
            
            // ì¤‘ì‹¬ì  ì—†ì´ ê²°ê³¼ ì´ë¯¸ì§€ ì¬ìƒì„± (ì œê±°ë¨)
            regenerateResultWithoutCenter(ctx) {
                // ì´ í•¨ìˆ˜ëŠ” ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤
                return;
            }
            
            // ì™„ì „í•œ ì—¬ë°± ì œê±° í•¨ìˆ˜ (ë‹¤ìš´ë¡œë“œìš©) - ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ
            autoCropCanvasOriginalRatio(ctx) {
                // ì´ í•¨ìˆ˜ëŠ” ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤
                return;
            }
            
            // í˜„ì¬ íŒ€ ì»¬ëŸ¬ ì´ë¦„ ê°€ì ¸ì˜¤ê¸°
            getCurrentColorName() {
                const colorMap = {
                    '#F40404': 'Red',
                    '#0C48CC': 'Blue',
                    '#2CB494': 'Teal',
                    '#88409C': 'Purple',
                    '#F88C14': 'Orange',
                    '#703014': 'Brown',
                    '#CCE0D0': 'White',
                    '#FCFC38': 'Yellow'
                };
                
                return colorMap[this.currentTeamColor.toUpperCase()] || 'Custom';
            }
            
            toggleSize(size) {
                const resultCanvas = document.getElementById('resultCanvas');
                const canvasGroup = resultCanvas.closest('.canvas-group');
                
                if (size !== 'original') {
                    const targetSize = parseInt(size);
                    
                    // ì›ë³¸ í¬ê¸° ì €ì¥
                    if (!resultCanvas.dataset.originalWidth) {
                        resultCanvas.dataset.originalWidth = resultCanvas.width;
                        resultCanvas.dataset.originalHeight = resultCanvas.height;
                        resultCanvas.dataset.originalStyle = resultCanvas.style.cssText;
                    }
                    
                    // ë¹„ìœ¨ ê³„ì‚°
                    const originalWidth = parseInt(resultCanvas.dataset.originalWidth);
                    const originalHeight = parseInt(resultCanvas.dataset.originalHeight);
                    const aspectRatio = originalWidth / originalHeight;
                    
                    // ì§€ì •ëœ í¬ê¸°ì˜ ì»¨í…Œì´ë„ˆ ì•ˆì—ì„œ ë¹„ìœ¨ ìœ ì§€í•˜ë©° ìµœëŒ€ í¬ê¸° ê³„ì‚°
                    let displayWidth, displayHeight;
                    if (aspectRatio > 1) {
                        // ê°€ë¡œê°€ ë” ê¸´ ê²½ìš°
                        displayWidth = targetSize;
                        displayHeight = targetSize / aspectRatio;
                    } else {
                        // ì„¸ë¡œê°€ ë” ê¸¸ê±°ë‚˜ ì •ì‚¬ê°í˜•ì¸ ê²½ìš°
                        displayHeight = targetSize;
                        displayWidth = targetSize * aspectRatio;
                    }
                    
                    // ê¸°ì¡´ ì»¨í…Œì´ë„ˆ ì œê±°
                    const existingContainer = resultCanvas.parentElement;
                    if (existingContainer.classList.contains('small-size-container')) {
                        const canvasGroup = existingContainer.parentElement;
                        canvasGroup.insertBefore(resultCanvas, existingContainer);
                        canvasGroup.removeChild(existingContainer);
                    }
                    
                    // ìƒˆ í¬ê¸° ì»¨í…Œì´ë„ˆ ìƒì„±
                    const container = document.createElement('div');
                    container.className = 'small-size-container';
                    container.style.cssText = `
                        width: ${targetSize}px;
                        height: ${targetSize}px;
                        background-color: rgba(0, 0, 0, 0.75);
                        border: 2px solid rgba(255, 255, 255, 0.3);
                        border-radius: 4px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        position: relative;
                    `;
                    
                    // ìº”ë²„ìŠ¤ë¥¼ ì»¨í…Œì´ë„ˆë¡œ ê°ì‹¸ê¸°
                    resultCanvas.parentElement.insertBefore(container, resultCanvas);
                    container.appendChild(resultCanvas);
                    
                    // ìº”ë²„ìŠ¤ ìŠ¤íƒ€ì¼ ì ìš©
                    resultCanvas.style.width = displayWidth + 'px';
                    resultCanvas.style.height = displayHeight + 'px';
                    resultCanvas.style.imageRendering = 'pixelated';
                    resultCanvas.style.imageRendering = '-moz-crisp-edges';
                    resultCanvas.style.imageRendering = 'crisp-edges';
                    resultCanvas.style.objectFit = 'contain';
                    resultCanvas.style.border = 'none';
                    resultCanvas.style.borderRadius = '0';
                    resultCanvas.style.boxShadow = 'none';
                    
                    this.log(`${targetSize}x${targetSize} í¬ê¸°ë¡œ ë³€ê²½ë¨ (ë°°ê²½: ${targetSize}x${targetSize}, ì´ë¯¸ì§€: ${displayWidth.toFixed(1)}x${displayHeight.toFixed(1)})`);
                } else {
                    // ì»¨í…Œì´ë„ˆì—ì„œ ìº”ë²„ìŠ¤ ì œê±°í•˜ê³  ì›ë˜ ìœ„ì¹˜ë¡œ ë³µì›
                    const container = resultCanvas.parentElement;
                    if (container.classList.contains('small-size-container')) {
                        const canvasGroup = container.parentElement;
                        canvasGroup.insertBefore(resultCanvas, container);
                        canvasGroup.removeChild(container);
                    }
                    
                    // ì›ë³¸ ìŠ¤íƒ€ì¼ë¡œ ë³µì›
                    if (resultCanvas.dataset.originalStyle) {
                        resultCanvas.style.cssText = resultCanvas.dataset.originalStyle;
                    } else {
                        resultCanvas.style.width = '';
                        resultCanvas.style.height = '';
                        resultCanvas.style.imageRendering = '';
                        resultCanvas.style.objectFit = '';
                        resultCanvas.style.border = '';
                        resultCanvas.style.borderRadius = '';
                        resultCanvas.style.boxShadow = '';
                    }
                    this.log('ì›ë³¸ í¬ê¸°ë¡œ ë³µì›ë¨');
                }
            }
        }
        
        // í”„ë¡œê·¸ë¨ ì‹œì‘
        let teamColorChanger;
        document.addEventListener('DOMContentLoaded', () => {
            teamColorChanger = new TeamColorChanger();
            teamColorChanger.log('í”„ë¡œê·¸ë¨ ì‹œì‘ë¨');
        });
    </script>
</body>
</html> ë°°ê²½ (fillRect í•˜ì§€ ì•ŠìŒ)
                
                // ê¸°ë³¸ ìœ ë‹› ëª¨ì–‘ (ë¡œë´‡) ê·¸ë¦¬ê¸°
                ctx.fillStyle = '#666666';
                ctx.fillRect(75, 50, 50, 100); // ëª¸ì²´
                
                ctx.fillStyle = '#888888';
                ctx.fillRect(85, 60, 30, 20); // ê°€ìŠ´
                
                ctx.fillStyle = '#444444';
                ctx.fillRect(65, 80, 20, 40); // ì™¼ìª½ íŒ”
                ctx.fillRect(115, 80, 20, 40); // ì˜¤ë¥¸ìª½ íŒ”
                
                ctx.fillStyle = '#555555';
                ctx.fillRect(85, 150, 12, 30); // ì™¼ìª½ ë‹¤ë¦¬
                ctx.fillRect(103, 150, 12, 30); // ì˜¤ë¥¸ìª½ ë‹¤ë¦¬
                
                ctx.fillStyle = '#999999';
                ctx.fillRect(90, 40, 20, 20); // ë¨¸ë¦¬
                
                // ëˆˆ
                ctx.fillStyle = '#ff0000';
                ctx.fillRect(93, 45, 3, 3);
                ctx.fillRect(104, 45, 3, 3);
                
                // ì•ˆí…Œë‚˜
                ctx.fillStyle = '#777777';
                ctx.fillRect(99, 35, 2, 10);
                
                // ì–´ê¹¨ ì¥ì‹
                ctx.fillStyle = '#aaaaaa';
                ctx.fillRect(70, 75, 8, 8);
                ctx.fillRect(122, 75, 8, 8);
                
                canvas.toBlob((blob) => {
                    const url = URL.createObjectURL(blob);
                    const img = new Image();
                    img.onload = () => {
                        this.diffuseImage = img;
                        this.drawImageToCanvas(img, this.originalCtx);
                        this.log('[SAMPLE] Diffuse ì´ë¯¸ì§€ ìƒì„± ì™„ë£Œ (íˆ¬ëª… ë°°ê²½)');
                        // ìƒ˜í”Œ ìƒì„± ì‹œ ê²°ê³¼ ìº”ë²„ìŠ¤ í¬ê¸° ì´ˆê¸°í™”
                        this.resetResultCanvasSize();
                        this.applyTeamColor();
                        URL.revokeObjectURL(url);
                    };
                    img.src = url;
                }, 'image/png'); // PNGë¡œ íˆ¬ëª…ë„ ë³´ì¡´
            }
            
            createSampleMask() {
                this.log('ìƒ˜í”Œ Team Color ë§ˆìŠ¤í¬ ìƒì„± ì¤‘...');
                const canvas = document.createElement('canvas');
                canvas.width = 200;
                canvas.height = 200;
                const ctx = canvas.getContext('2d');
                
                // íˆ¬ëª…